---
layout: single
classes: wide
title: "Running jobs"
permalink: /running-jobs
sidebar:
  nav: "docs"
---

## A basic single-node job
In order to run an instance of a container, running the command defined in the imageâ€™s entrypoint, all you need to do is to specify the Docker Hub image name:
```
prominence create alahiff/testpi
```

> output

```
Job created with id 3101
```
When a job has been successfully submitted an (integer) ID will be returned. Alternatively, a command (and arguments) can be specified. For example:
``` 
prominence create alahiff/testpi "/bin/sleep 100"
``` 
The command of course should exist within the container. If arguments need to be specified you should put the command and any arguments inside a single set of double quotes, as in the example above.

As alternatives to a Docker Hub image name, a URL pointing to a Singularity image or Docker tarball can be specified.

## MPI jobs
To run an MPI job, you need to specify either `--openmpi` for OpenMPI or `--mpich` for MPICH. For multi-node jobs the number of nodes required should also be specified. For example:
```
prominence create --openmpi --nodes 4 alahiff/openmpi-hello-world:latest /mpi_hello_world
```

## Resources
By default a job will be run with 1 CPU and 1 GB memory but this can easily be changed using the `--cpus` and `--memory` options. A disk size can also be specified using `--disk`. Here is an example running an MPI job on 4 nodes where each node has 2 CPUs and 8 GB memory, there is a shared 20 GB disk accessible by all 4 nodes, and the maximum runtime is 1000 minutes:
```
prominence create --openmpi --nodes 4 --cpus 2 --memory 8 --disk 20 --runtime 1000 alahiff/geant4mpi:1.3a3
```
By default a 10 GB disk is available to jobs, which is located on separate block storage. For MPI jobs the disk is available across all nodes running the job. The default maximum runtime is 720 minutes.

## Working directory
By default the current working directory is scratch space made available inside the container. The path to this directory is also specified by the environment variables HOME, TEMP and TMP.

To specify a different working directory use `--workdir`.

**Note:** Remember that you should not try to write inside the container's filesystem as this may be prevented by the container runtime or result in permission problems.
{: .notice--warning}

## Multiple tasks in a single job
By default a job will run a single command inside a single container. However, it is possible to instead run multiple sequential tasks within a single job. Each task will have access to the same temporary storage, so transient files generated by one task are accessible by other tasks.

To run multiple tasks in a single job requires the user to define a JSON job description which can then be submitted using the CLI. A simple way to do this is to start by using `prominence create --dry-run` (see [here](/docs/generating-json)) to create the JSON description for a job with a single task, and then modify this as necessary.

Below a simple example is shown which runs a CentOS container followed by a Ubuntu container:
```json
{
  "resources": {
    "nodes": 1,
    "cpus": 1,
    "memory": 1,
    "disk": 10
  },
  "tasks": [
    {
      "image": "centos:7",
      "cmd": "cat /etc/redhat-release",
      "runtime": "singularity"
    },
    {
      "image": "ubuntu:16.04",
      "cmd": "cat /etc/debian_version",
      "runtime": "singularity"
    }
  ],
  "name": "multiple-tasks"
}
```
Assuming the above is stored in a file called `single-job-multiple-tasks.json`, it can be submitted by running:
```
prominence run single-job-multiple-tasks.json
```

**Note:** Different tasks do not have to use the same container runtime. It is possible for some tasks to use udocker while others use Singularity.
{: .notice--info}
